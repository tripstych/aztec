"use strict";var _createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(i,t){function e(){_classCallCheck(this,e),this.setElements(),this.events()}new(_createClass(e,[{key:"setElements",value:function(){this.el={$pluginInactivatedList:i(".jupiterx-core-install-rplugins-failed"),$error:i(".jupiterx-core-install-rplugins-error"),$activeBtn:i(".jupiterx-core-install-button")}}},{key:"events",value:function(){var e=this;i(document).on("click",".jupiterx-core-install-button",function(t){t.preventDefault(),e.fetchInactiveRequiredPlugins()})}},{key:"installPlugins",value:function(t){var e=this;this.el.$activeBtn.addClass("installing").attr("disabled","disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.installText+"..."),i.ajax({url:t.install_required_plugins.url,method:"POST",data:t.install_required_plugins,success:function(){e.el.$activeBtn.removeClass("installing").removeAttr("disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.defaultText),e.activatePlugins(t)},error:function(){e.el.$activeBtn.removeClass("installing").removeAttr("disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.defaultText),e.el.$pluginInactivatedList.find(".core-install-plugin-error div").append(jupiterxCoreInstall.i18n.failedInstallText).append(jupiterxCoreInstall.i18n.failedActionLinks),e.el.$pluginInactivatedList.find(".core-install-plugin-error").show(),e.el.$pluginInactivatedList.show()}})}},{key:"activatePlugins",value:function(t){var e=this;this.el.$activeBtn.addClass("activating").attr("disabled","disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.activateText+"..."),i.ajax({url:t.activate_required_plugins.url,method:"POST",data:t.activate_required_plugins,success:function(){e.el.$activeBtn.removeClass("activating").find("span:last-child").text(jupiterxCoreInstall.i18n.redirecting+"..."),window.location.href=jupiterxCoreInstall.controlPanelUrl},error:function(){e.el.$activeBtn.removeClass("activating").removeAttr("disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.defaultText),e.el.$pluginInactivatedList.find(".core-install-plugin-error div").append(jupiterxCoreInstall.i18n.failedActivateText).append(jupiterxCoreInstall.i18n.failedActionLinks),e.el.$pluginInactivatedList.find(".core-install-plugin-error").show(),e.el.$pluginInactivatedList.show()}})}},{key:"fetchInactiveRequiredPlugins",value:function(){var e=this;this.el.$activeBtn.addClass("activating").attr("disabled","disabled").find("span:last-child").text(jupiterxCoreInstall.i18n.fetchText+"..."),t.ajax.post("jupiterx_get_plugins",{_ajax_nonce:this.el.$activeBtn.data("nonce")}).done(function(t){e.installPlugins(t.bulk_actions),t&&t.bulk_actions&&0!==t.bulk_actions.length&&t&&t.plugins&&0!==t.plugins.length?e.toggleError(!1):e.toggleError(!0)}).fail(function(){e.toggleError(!0)})}},{key:"toggleError",value:function(t){t?this.el.$error.css("display","flex"):this.el.$error.css("display","none")}}]),e)}(jQuery,wp);